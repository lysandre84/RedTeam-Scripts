#!/usr/bin/env python3
'''''
=====================================================================================================================================================
   
 /$$$$$$$                  /$$ /$$$$$$$$                                         /$$$$$$                      /$$             /$$             
| $$__  $$                | $$|__  $$__/                                        /$$__  $$                    |__/            | $$             
| $$  \ $$  /$$$$$$   /$$$$$$$   | $$  /$$$$$$   /$$$$$$  /$$$$$$/$$$$         | $$  \__/  /$$$$$$$  /$$$$$$  /$$  /$$$$$$  /$$$$$$   /$$$$$$$
| $$$$$$$/ /$$__  $$ /$$__  $$   | $$ /$$__  $$ |____  $$| $$_  $$_  $$ /$$$$$$|  $$$$$$  /$$_____/ /$$__  $$| $$ /$$__  $$|_  $$_/  /$$_____/
| $$__  $$| $$$$$$$$| $$  | $$   | $$| $$$$$$$$  /$$$$$$$| $$ \ $$ \ $$|______/ \____  $$| $$      | $$  \__/| $$| $$  \ $$  | $$   |  $$$$$$ 
| $$  \ $$| $$_____/| $$  | $$   | $$| $$_____/ /$$__  $$| $$ | $$ | $$         /$$  \ $$| $$      | $$      | $$| $$  | $$  | $$ /$$\____  $$
| $$  | $$|  $$$$$$$|  $$$$$$$   | $$|  $$$$$$$|  $$$$$$$| $$ | $$ | $$        |  $$$$$$/|  $$$$$$$| $$      | $$| $$$$$$$/  |  $$$$//$$$$$$$/ 
|__/  |__/ \_______/ \_______/   |__/ \_______/ \_______/|__/ |__/ |__/         \______/  \_______/|__/      |__/| $$____/    \___/ |_______/ 
                                                                                                                 | $$                         
                                                                                                                 | $$                         
                                                                                                                 |__/                         
=====================================================================================================================================================
=====================================================================================================================================================
Script     : password_cracker.py
Auteur     : Lysius
Date       : 31/12/2024
Description: Cracker de hash MD5 simple par dictionnaire
=====================================================================================================================================================
'''''
import argparse, hashlib

def crack_hashes(hash_file, dict_file):
    hashes = {line.strip(): None for line in open(hash_file)}
    for word in open(dict_file):
        w = word.strip()
        w_hash = hashlib.md5(w.encode()).hexdigest()
        if w_hash in hashes:
            hashes[w_hash] = w
    return hashes

if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('--hashes', required=True, help='Fichier de hashes')
    parser.add_argument('--dict', default='wordlist.txt', help='Fichier dictionnaire')
    args = parser.parse_args()
    results = crack_hashes(args.hashes, args.dict)
    for h, pwd in results.items():
        print(f"{h} -> {pwd if pwd else 'not found'}")